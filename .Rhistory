mutate(Text = as.factor(.[,1])) %>%
select(Text) %>%
separate(Text,into = c("Name","Dialogue"), sep = ":", remove = TRUE, convert = FALSE, extra = "merge")
print("3")
bind <- cbind(sc$Name,Season,sc$Dialogue)
Speakers <- rbind(Speakers,bind)
}
Speaker <- Speakers[-1,]
Speaker <- as.data.frame(Speaker)
colnames(Speaker) <- c("Name","Season","Dialogue")
fix.contractions <- function(doc) {
doc <- gsub("won't", "will not", doc)
doc <- gsub("can't", "can not", doc)
doc <- gsub("n't", " not", doc)
doc <- gsub("'ll", " will", doc)
doc <- gsub("'re", " are", doc)
doc <- gsub("'ve", " have", doc)
doc <- gsub("'m", " am", doc)
doc <- gsub("'d", " would", doc)
doc <- gsub("'s", " is", doc)
doc <- gsub("C'mon", "Come on", doc)
return(doc)
}
removeSpecialChars <- function(x) gsub("[^a-zA-Z0-9 ]", " ", x)
Speakerd <- as.data.frame(sapply(Speaker, fix.contractions))
Speakerd <- as.data.frame(sapply(Speakerd, removeSpecialChars))
Speakerd <- as.data.frame(sapply(Speakerd, tolower))
Speakerd$Dialogue <- as.character(Speakerd$Dialogue)
Number_Spoken <-Speakerd %>%
group_by(Name,Season) %>%
count(Name) %>%
arrange(desc(n)) %>%
ungroup() %>%
mutate(Count = n) %>%
select(-n) %>%
filter(Name == "monica"|
Name == "joey"|
Name == "chandler"|
Name == "phoebe"|
Name == "ross"|
Name == "rachel") %>%
mutate(Name = fct_reorder(Name,Count)) %>%
ggplot(aes(x=Name,
y=Count,
fill = Name,
label = Count))+
geom_bar(stat = "identity")+
geom_text(position = "stack", hjust = 0.5, vjust =1 )+
theme(legend.position = "none")+
labs(title = "Number of times spoken by each character",
xlab = "Characters",
ylab = "Number of times spoken")+
facet_wrap(~ Season,nrow = 5,"free_y")
Number_Spoken
Speakerd %>%
mutate(n_words = str_count(Dialogue)) %>%
group_by(Name,Season) %>%
summarise(n_words = sum(n_words)) %>%
arrange(desc(n_words)) %>%
filter(Name == "monica"|
Name == "joey"|
Name == "chandler"|
Name == "phoebe"|
Name == "ross"|
Name == "rachel") %>%
ungroup() %>%
mutate(Name = fct_reorder(Name,n_words)) %>%
ggplot(aes(x=Name,
y=n_words,
fill = Name,
label = n_words))+
geom_bar(stat = "identity")+
geom_text(position = "stack", hjust = 0.5, vjust =1 )+
theme(legend.position = "none")+
labs(title = "Word Count",
xlab = "Characters",
ylab = "Count of words")+
facet_wrap(~ Season,nrow = 5,"free_y")
Speakerd %>%
mutate(n_words = str_count(Dialogue)) %>%
group_by(Name,Season) %>%
mutate(n_words = sum(n_words)) %>%
add_count(Name) %>%
arrange(desc(n_words),desc(n)) %>%
filter(Name == "monica"|
Name == "joey"|
Name == "chandler"|
Name == "phoebe"|
Name == "ross"|
Name == "rachel") %>%
ggplot(aes(x=n_words,
y=n,
label = Name))+
geom_point()+
geom_text(size = 3, check_overlap = TRUE)+
facet_wrap(~ Season,nrow = 5,"free_y")+
labs(title = "Dialogue Delivery",
x = "Number of words",
y = "Number of Times Spoke")
sf <- Speakerd %>%
filter(Name == "monica"|
Name == "joey"|
Name == "chandler"|
Name == "phoebe"|
Name == "ross")
sf <- sf %>%
separate(Dialogue,into = c(as.character(1:max(sapply(strsplit(sf$Dialogue, " "), length)))), sep = " ", remove = TRUE, convert = FALSE, fill = "right")
#sf[c(which(sf=="")),] <- NA
class(sf$`1`[1])
setwd("C:\\Users\\Vinod\\Desktop\\MIS\\Project\\Dataset")
amazon_review <- read.csv("amazon.csv", stringsAsFactors = FALSE)
knitr::opts_chunk$set(echo = TRUE)
sf
knitr::opts_chunk$set(echo = TRUE)
library(rvest)
library(here)
library(tidyverse)
library(rlist)
library(RCurl)
library(urltools)
library(httr)
library(readtext)
#install.packages('RColorBrewer')
#most of the libraries needed
library(dplyr) #data manipulation
library(ggplot2) #visualizations
library(gridExtra) #viewing multiple plots together
library(tidytext) #text mining
library(wordcloud2) #creative visualizations
library(RColorBrewer)
library(tm)
library(NLP)
library(wordcloud)
library(stringr)
myFiles <- list.files(path = "C://Users//Vinod//Desktop//Multivariate Analysis//Friends//Data", pattern = "\\.txt$")
title <- gsub("\\..*","",myFiles)
h <- c()
for (i in title){
print(i)
readtxt <- read_csv(here("Data",paste0(i,".txt")))
h <- append(h,readtxt,after = length(h))
}
league <- setNames(as.list(h), title)
#colnames(as.data.frame(league[228]))
Speakers <- matrix(ncol=3,nrow=1)
#Speakers$Name <- as.character(Speakers$Name)
progress<- c()
for (j in league){
progress <- append(progress,".")
length <- length(progress)
print(length(progress))
if (length>=1 & length <= 24){
Season = "Season 1"
}
if (length>=25 & length <= 47){
Season <- "Season 2"
}
if (length>=48 & length <= 72){
Season <- "Season 3"
}
if (length>=73 & length <= 95){
Season <- "Season 4"
}
if (length>=96 & length <= 118){
Season <- "Season 5"
}
if (length>=119 & length <= 141){
Season <- "Season 6"
}
if (length>=142 & length <= 165){
Season <- "Season 7"
}
if (length >= 166 & length <= 188){
Season <- "Season 8"
}
if (length>=189 & length <= 211){
Season <- "Season 9"
}
if (length>=212 & length <= 228){
Season <- "Season 10"
}
sc<- as.data.frame(j)
sc[,1] <- as.character(sc[,1])
print("1")
for (i in (sc[,1])){
check = str_detect(i,":")
rown <- which(sc[,1] %in% i)
if (check == FALSE){
sc[rown-1, ] <- paste(sc[rown-1, ],".", sc[rown, ])
}
}
library(tools)
print("2")
sc <- sc %>%
slice(-c(which(str_detect(.[,1],":")==FALSE))) %>%
mutate(Text = as.factor(.[,1])) %>%
select(Text) %>%
separate(Text,into = c("Name","Dialogue"), sep = ":", remove = TRUE, convert = FALSE, extra = "merge")
print("3")
bind <- cbind(sc$Name,Season,sc$Dialogue)
Speakers <- rbind(Speakers,bind)
}
Speaker <- Speakers[-1,]
Speaker <- as.data.frame(Speaker)
colnames(Speaker) <- c("Name","Season","Dialogue")
fix.contractions <- function(doc) {
doc <- gsub("won't", "will not", doc)
doc <- gsub("can't", "can not", doc)
doc <- gsub("n't", " not", doc)
doc <- gsub("'ll", " will", doc)
doc <- gsub("'re", " are", doc)
doc <- gsub("'ve", " have", doc)
doc <- gsub("'m", " am", doc)
doc <- gsub("'d", " would", doc)
doc <- gsub("'s", " is", doc)
doc <- gsub("C'mon", "Come on", doc)
return(doc)
}
removeSpecialChars <- function(x) gsub("[^a-zA-Z0-9 ]", " ", x)
Speakerd <- as.data.frame(sapply(Speaker, fix.contractions))
Speakerd <- as.data.frame(sapply(Speakerd, removeSpecialChars))
Speakerd <- as.data.frame(sapply(Speakerd, tolower))
Speakerd$Dialogue <- as.character(Speakerd$Dialogue)
Number_Spoken <-Speakerd %>%
group_by(Name,Season) %>%
count(Name) %>%
arrange(desc(n)) %>%
ungroup() %>%
mutate(Count = n) %>%
select(-n) %>%
filter(Name == "monica"|
Name == "joey"|
Name == "chandler"|
Name == "phoebe"|
Name == "ross"|
Name == "rachel") %>%
mutate(Name = fct_reorder(Name,Count)) %>%
ggplot(aes(x=Name,
y=Count,
fill = Name,
label = Count))+
geom_bar(stat = "identity")+
geom_text(position = "stack", hjust = 0.5, vjust =1 )+
theme(legend.position = "none")+
labs(title = "Number of times spoken by each character",
xlab = "Characters",
ylab = "Number of times spoken")+
facet_wrap(~ Season,nrow = 5,"free_y")
Number_Spoken
Speakerd %>%
mutate(n_words = str_count(Dialogue)) %>%
group_by(Name,Season) %>%
summarise(n_words = sum(n_words)) %>%
arrange(desc(n_words)) %>%
filter(Name == "monica"|
Name == "joey"|
Name == "chandler"|
Name == "phoebe"|
Name == "ross"|
Name == "rachel") %>%
ungroup() %>%
mutate(Name = fct_reorder(Name,n_words)) %>%
ggplot(aes(x=Name,
y=n_words,
fill = Name,
label = n_words))+
geom_bar(stat = "identity")+
geom_text(position = "stack", hjust = 0.5, vjust =1 )+
theme(legend.position = "none")+
labs(title = "Word Count",
xlab = "Characters",
ylab = "Count of words")+
facet_wrap(~ Season,nrow = 5,"free_y")
Speakerd %>%
mutate(n_words = str_count(Dialogue)) %>%
group_by(Name,Season) %>%
mutate(n_words = sum(n_words)) %>%
add_count(Name) %>%
arrange(desc(n_words),desc(n)) %>%
filter(Name == "monica"|
Name == "joey"|
Name == "chandler"|
Name == "phoebe"|
Name == "ross"|
Name == "rachel") %>%
ggplot(aes(x=n_words,
y=n,
label = Name))+
geom_point()+
geom_text(size = 3, check_overlap = TRUE)+
facet_wrap(~ Season,nrow = 5,"free_y")+
labs(title = "Dialogue Delivery",
x = "Number of words",
y = "Number of Times Spoke")
sf <- Speakerd %>%
filter(Name == "monica"|
Name == "joey"|
Name == "chandler"|
Name == "phoebe"|
Name == "ross")
sf <- sf %>%
separate(Dialogue,into = c(as.character(1:max(sapply(strsplit(sf$Dialogue, " "), length)))), sep = " ", remove = TRUE, convert = FALSE, fill = "right")
sf
knitr::opts_chunk$set(echo = TRUE)
library(rvest)
library(here)
library(tidyverse)
library(rlist)
library(RCurl)
library(urltools)
library(httr)
library(readtext)
#install.packages('RColorBrewer')
#most of the libraries needed
library(dplyr) #data manipulation
library(ggplot2) #visualizations
library(gridExtra) #viewing multiple plots together
library(tidytext) #text mining
library(wordcloud2) #creative visualizations
library(RColorBrewer)
library(tm)
library(NLP)
library(wordcloud)
library(stringr)
myFiles <- list.files(path = "C://Users//Vinod//Desktop//Multivariate Analysis//Friends//Data", pattern = "\\.txt$")
title <- gsub("\\..*","",myFiles)
h <- c()
for (i in title){
print(i)
readtxt <- read_csv(here("Data",paste0(i,".txt")))
h <- append(h,readtxt,after = length(h))
}
league <- setNames(as.list(h), title)
#colnames(as.data.frame(league[228]))
Speakers <- matrix(ncol=3,nrow=1)
#Speakers$Name <- as.character(Speakers$Name)
progress<- c()
for (j in league){
progress <- append(progress,".")
length <- length(progress)
print(length(progress))
if (length>=1 & length <= 24){
Season = "Season 1"
}
if (length>=25 & length <= 47){
Season <- "Season 2"
}
if (length>=48 & length <= 72){
Season <- "Season 3"
}
if (length>=73 & length <= 95){
Season <- "Season 4"
}
if (length>=96 & length <= 118){
Season <- "Season 5"
}
if (length>=119 & length <= 141){
Season <- "Season 6"
}
if (length>=142 & length <= 165){
Season <- "Season 7"
}
if (length >= 166 & length <= 188){
Season <- "Season 8"
}
if (length>=189 & length <= 211){
Season <- "Season 9"
}
if (length>=212 & length <= 228){
Season <- "Season 10"
}
sc<- as.data.frame(j)
sc[,1] <- as.character(sc[,1])
print("1")
for (i in (sc[,1])){
check = str_detect(i,":")
rown <- which(sc[,1] %in% i)
if (check == FALSE){
sc[rown-1, ] <- paste(sc[rown-1, ],".", sc[rown, ])
}
}
library(tools)
print("2")
sc <- sc %>%
slice(-c(which(str_detect(.[,1],":")==FALSE))) %>%
mutate(Text = as.factor(.[,1])) %>%
select(Text) %>%
separate(Text,into = c("Name","Dialogue"), sep = ":", remove = TRUE, convert = FALSE, extra = "merge")
print("3")
bind <- cbind(sc$Name,Season,sc$Dialogue)
Speakers <- rbind(Speakers,bind)
}
Speaker <- Speakers[-1,]
Speaker <- as.data.frame(Speaker)
colnames(Speaker) <- c("Name","Season","Dialogue")
fix.contractions <- function(doc) {
doc <- gsub("won't", "will not", doc)
doc <- gsub("can't", "can not", doc)
doc <- gsub("n't", " not", doc)
doc <- gsub("'ll", " will", doc)
doc <- gsub("'re", " are", doc)
doc <- gsub("'ve", " have", doc)
doc <- gsub("'m", " am", doc)
doc <- gsub("'d", " would", doc)
doc <- gsub("'s", " is", doc)
doc <- gsub("C'mon", "Come on", doc)
return(doc)
}
removeSpecialChars <- function(x) gsub("[^a-zA-Z0-9 ]", " ", x)
Speakerd <- as.data.frame(sapply(Speaker, fix.contractions))
Speakerd <- as.data.frame(sapply(Speakerd, removeSpecialChars))
Speakerd <- as.data.frame(sapply(Speakerd, tolower))
Speakerd$Dialogue <- as.character(Speakerd$Dialogue)
fix.contractions <- function(doc) {
doc <- gsub("won't", "will not", doc)
doc <- gsub("can't", "can not", doc)
doc <- gsub("n't", " not", doc)
doc <- gsub("'ll", " will", doc)
doc <- gsub("'re", " are", doc)
doc <- gsub("'ve", " have", doc)
doc <- gsub("'m", " am", doc)
doc <- gsub("'d", " would", doc)
doc <- gsub("'s", " is", doc)
doc <- gsub("C'mon", "Come on", doc)
return(doc)
}
removeSpecialChars <- function(x) gsub("[^a-zA-Z0-9 ]", " ", x)
Speakerd <- as.data.frame(sapply(Speaker, fix.contractions))
Speakerd <- as.data.frame(sapply(Speakerd, removeSpecialChars))
Speakerd <- as.data.frame(sapply(Speakerd, tolower))
Speakerd$Dialogue <- as.character(Speakerd$Dialogue)
Speakerd
Number_Spoken <-Speakerd %>%
group_by(Name,Season) %>%
count(Name) %>%
arrange(desc(n)) %>%
ungroup() %>%
mutate(Count = n) %>%
select(-n) %>%
filter(Name == "monica"|
Name == "joey"|
Name == "chandler"|
Name == "phoebe"|
Name == "ross"|
Name == "rachel") %>%
mutate(Name = fct_reorder(Name,Count)) %>%
ggplot(aes(x=Name,
y=Count,
fill = Name,
label = Count))+
geom_bar(stat = "identity")+
geom_text(position = "stack", hjust = 0.5, vjust =1 )+
theme(legend.position = "none")+
labs(title = "Number of times spoken by each character",
xlab = "Characters",
ylab = "Number of times spoken")+
facet_wrap(~ Season,nrow = 5,"free_y")
Number_Spoken
Speakerd %>%
mutate(n_words = str_count(Dialogue)) %>%
group_by(Name,Season) %>%
summarise(n_words = sum(n_words)) %>%
arrange(desc(n_words)) %>%
filter(Name == "monica"|
Name == "joey"|
Name == "chandler"|
Name == "phoebe"|
Name == "ross"|
Name == "rachel") %>%
ungroup() %>%
mutate(Name = fct_reorder(Name,n_words)) %>%
ggplot(aes(x=Name,
y=n_words,
fill = Name,
label = n_words))+
geom_bar(stat = "identity")+
geom_text(position = "stack", hjust = 0.5, vjust =1 )+
theme(legend.position = "none")+
labs(title = "Word Count",
xlab = "Characters",
ylab = "Count of words")+
facet_wrap(~ Season,nrow = 5,"free_y")
Speakerd %>%
mutate(n_words = str_count(Dialogue)) %>%
group_by(Name,Season) %>%
mutate(n_words = sum(n_words)) %>%
add_count(Name) %>%
arrange(desc(n_words),desc(n)) %>%
filter(Name == "monica"|
Name == "joey"|
Name == "chandler"|
Name == "phoebe"|
Name == "ross"|
Name == "rachel") %>%
ggplot(aes(x=n_words,
y=n,
label = Name))+
geom_point()+
geom_text(size = 3, check_overlap = TRUE)+
facet_wrap(~ Season,nrow = 5,"free_y")+
labs(title = "Dialogue Delivery",
x = "Number of words",
y = "Number of Times Spoke")
sf <- Speakerd %>%
filter(Name == "monica"|
Name == "joey"|
Name == "chandler"|
Name == "phoebe"|
Name == "ross")
sf <- sf %>%
separate(Dialogue,into = c(as.character(1:max(sapply(strsplit(sf$Dialogue, " "), length)))), sep = " ", remove = TRUE, convert = FALSE, fill = "right")
sf[c(which(sf=="")),] <- NA
